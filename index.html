<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Narrativ — Book Diary</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 900px;
      margin: 2rem auto;
      background: #f0f4f8;
      color: #222;
      padding: 0 1rem;
    }
    header {
      text-align: center;
      margin-bottom: 2rem;
    }
    header h1 {
      font-size: 2.5rem;
      margin-bottom: 0.3rem;
      color: #2c3e50;
    }
    header input[type="search"] {
      width: 100%;
      max-width: 400px;
      padding: 0.6rem 1rem;
      font-size: 1.1rem;
      border-radius: 25px;
      border: 1px solid #ccc;
      transition: border-color 0.3s ease;
    }
    header input[type="search"]:focus {
      border-color: #2980b9;
      outline: none;
    }

    form {
      background: white;
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: 0 3px 15px rgba(0,0,0,0.1);
      margin-bottom: 2rem;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1rem 1.5rem;
    }
    form textarea {
      grid-column: 1 / -1;
      resize: vertical;
      min-height: 80px;
      padding: 0.5rem;
      font-size: 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
    }
    form input, form select {
      font-size: 1rem;
      padding: 0.5rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      width: 100%;
    }
    form button {
      grid-column: 1 / -1;
      background: #2c3e50;
      color: white;
      font-weight: 600;
      font-size: 1.1rem;
      border: none;
      padding: 0.7rem;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    form button:hover {
      background: #3a6ea5;
    }

    #booksGrid {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(250px,1fr));
      gap: 1.5rem;
    }

    .bookCard {
      background: white;
      border-radius: 12px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      position: relative;
      transition: transform 0.2s ease;
    }
    .bookCard:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(0,0,0,0.15);
    }

    .bookCard img {
      width: 100%;
      height: 320px;
      object-fit: cover;
      background: #ddd;
    }
    .bookContent {
      padding: 1rem 1.2rem;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
    .bookContent h3 {
      margin: 0 0 0.3rem 0;
      font-size: 1.2rem;
      color: #2c3e50;
    }
    .bookContent p.author {
      margin: 0 0 0.5rem 0;
      color: #555;
      font-style: italic;
      font-size: 0.9rem;
    }
    .bookContent p.review {
      flex-grow: 1;
      font-size: 0.95rem;
      color: #333;
      margin-bottom: 1rem;
      white-space: pre-line;
    }
    .bookContent .rating {
      font-weight: 700;
      color: #e0a800;
      margin-bottom: 1rem;
      font-size: 1.1rem;
    }

    .bookCard button.deleteBtn {
      position: absolute;
      top: 12px;
      right: 12px;
      background: #d9534f;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      color: white;
      font-weight: bold;
      font-size: 18px;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
      transition: background-color 0.3s ease;
    }
    .bookCard button.deleteBtn:hover {
      background: #c9302c;
    }

    @media (max-width: 600px) {
      form {
        grid-template-columns: 1fr;
      }
      form textarea {
        grid-column: 1;
      }
    }
  </style>
</head>
<body>

<header>
  <h1>Narrativ</h1>
  <input
    id="searchInput"
    type="search"
    placeholder="Search books by title or author..."
    aria-label="Search books"
  />
</header>

<main>
  <form id="bookForm" novalidate>
    <input type="text" id="title" placeholder="Book Title *" required />
    <input type="text" id="author" placeholder="Author *" required />
    <input type="url" id="cover" placeholder="Cover Image URL (optional)" />
    <select id="rating" required>
      <option value="" disabled selected>Rating *</option>
      <option value="1">1 ⭐</option>
      <option value="2">2 ⭐⭐</option>
      <option value="3">3 ⭐⭐⭐</option>
      <option value="4">4 ⭐⭐⭐⭐</option>
      <option value="5">5 ⭐⭐⭐⭐⭐</option>
    </select>
    <textarea id="review" placeholder="Write a short review or notes (optional)"></textarea>
    <button type="submit">Add Book</button>
  </form>

  <section id="booksGrid" aria-live="polite" aria-label="List of books"></section>
</main>

<script>
  const form = document.getElementById('bookForm');
  const booksGrid = document.getElementById('booksGrid');
  const searchInput = document.getElementById('searchInput');

  let books = JSON.parse(localStorage.getItem('narrativBooks')) || [];

  function saveBooks() {
    localStorage.setItem('narrativBooks', JSON.stringify(books));
  }

  function renderBooks(filter = '') {
    booksGrid.innerHTML = '';

    const filteredBooks = books.filter(book => {
      const text = (book.title + ' ' + book.author).toLowerCase();
      return text.includes(filter.toLowerCase());
    });

    if (filteredBooks.length === 0) {
      booksGrid.innerHTML = '<p style="text-align:center; color:#777; margin-top:2rem;">No books found.</p>';
      return;
    }

    filteredBooks.forEach((book, index) => {
      const card = document.createElement('article');
      card.className = 'bookCard';

      const img = document.createElement('img');
      img.src = book.cover || 'https://via.placeholder.com/400x320?text=No+Cover';
      img.alt = `Cover of ${book.title}`;
      card.appendChild(img);

      const content = document.createElement('div');
      content.className = 'bookContent';

      const title = document.createElement('h3');
      title.textContent = book.title;
      content.appendChild(title);

      const author = document.createElement('p');
      author.className = 'author';
      author.textContent = `by ${book.author}`;
      content.appendChild(author);

      const rating = document.createElement('p');
      rating.className = 'rating';
      rating.textContent = '⭐'.repeat(book.rating);
      content.appendChild(rating);

      if (book.review) {
        const review = document.createElement('p');
        review.className = 'review';
        review.textContent = book.review;
        content.appendChild(review);
      }

      card.appendChild(content);

      const delBtn = document.createElement('button');
      delBtn.className = 'deleteBtn';
      delBtn.title = `Delete "${book.title}"`;
      delBtn.setAttribute('aria-label', `Delete book ${book.title}`);
      delBtn.textContent = '×';
      delBtn.addEventListener('click', () => {
        if (confirm(`Delete "${book.title}"?`)) {
          books.splice(index, 1);
          saveBooks();
          renderBooks(searchInput.value);
        }
      });
      card.appendChild(delBtn);

      booksGrid.appendChild(card);
    });
  }

  form.addEventListener('submit', e => {
    e.preventDefault();

    const title = form.title.value.trim();
    const author = form.author.value.trim();
    const cover = form.cover.value.trim();
    const rating = parseInt(form.rating.value);
    const review = form.review.value.trim();

    if (!title || !author || !rating) {
      alert('Please fill in all required fields marked with *');
      return;
    }

    books.push({ title, author, cover, rating, review });
    saveBooks();
    renderBooks(searchInput.value);
    form.reset();
    form.title.focus();
  });

  searchInput.addEventListener('input', e => {
    renderBooks(e.target.value);
  });

  renderBooks();
</script>

</body>
</html>
